var Location=function(e){"use strict";this.title=ko.observable(e.title),this.id=ko.observable(e.id),this.marker=ko.observable(),this.address=ko.observable(""),this.rating=ko.observable(""),this.likes=ko.observable(""),this.photo=ko.observable(""),this.url=ko.observable("")},locations=[{title:"Walnut Creek Metropolitan Park",id:"4ae37a96f964a520a39521e3",coordinates:{lat:30.399123,lng:-97.679489}},{title:"Red Bud Isle",id:"49c1de70f964a520d7551fe3",coordinates:{lat:30.29082,lng:-97.786839}},{title:"Emma Long Metropolitan Park",id:"49f3314df964a5206b6a1fe3",coordinates:{lat:30.335234,lng:-97.838505}},{title:"Barton Creek Greenbelt",id:"4ae33705f964a520c69121e3",coordinates:{lat:30.243167,lng:-97.800045}},{title:"St. Edward's Park",id:"4b328c55f964a520530e25e3",coordinates:{lat:30.407556,lng:-97.791037}},{title:"River Place Nature Trail",id:"4da9e0594df01c19b17cabce",coordinates:{lat:30.356231,lng:-97.864022}}];
var austin={lat:30.2672,lng:-97.7431},styles=[{elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{color:"#f5f5f2"},{visibility:"on"}]},{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"poi.attraction",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{visibility:"on"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.medical",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#ffffff"},{visibility:"simplified"}]},{featureType:"road.arterial",stylers:[{visibility:"simplified"},{color:"#ffffff"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{color:"#ffffff"},{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.arterial",stylers:[{color:"#ffffff"}]},{featureType:"road.local",stylers:[{color:"#ffffff"}]},{featureType:"poi.park",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:"#71c8d4"}]},{featureType:"landscape",stylers:[{color:"#e5e8e7"}]},{featureType:"poi.park",stylers:[{color:"#8ba129"}]},{featureType:"road",stylers:[{color:"#ffffff"}]},{featureType:"poi.sports_complex",elementType:"geometry",stylers:[{color:"#c7c7c7"},{visibility:"off"}]},{featureType:"water",stylers:[{color:"#a0d3d3"}]},{featureType:"poi.park",stylers:[{color:"#91b65d"}]},{featureType:"poi.park",stylers:[{gamma:1.51}]},{featureType:"road.local",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"poi.government",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road.local",stylers:[{visibility:"simplified"}]},{featureType:"road"},{featureType:"road"},{},{featureType:"road.highway"}];
function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:austin,zoom:12,styles:styles}),info=new google.maps.InfoWindow,ko.applyBindings(new AppViewModel)}function createMarker(n,e){return new google.maps.Marker({position:e,map:map,title:n,icon:"img/marker.png",animation:google.maps.Animation.DROP})}function mapError(){"use strict";alert("Google Maps is currently unavailable")}var map,info;
var foursquare_id="XRATIK2410KTJDQKQQLZRFWYE5FRIFYBH5N5CIL2AABCLVYV",foursquare_secret="OKBTT3QC2X5GPOSEZZMY4YABWLQ2DHFEDRGTLOLRD3BSMWBJ";
function AppViewModel(){var r=this;this.searchText=ko.observable(""),this.error=ko.observable(""),this.locationArray=ko.observableArray([]),this.visibleArray=ko.observableArray([]),this.searchOpen=ko.observable(!1),this.openSearch=function(){this.searchOpen(!this.searchOpen())},locations.forEach(function(e){newLocation=new Location(e),newLocation.marker=createMarker(e.title,e.coordinates),r.locationArray.push(newLocation),r.visibleArray.push(newLocation)}),this.locationArray().forEach(function(r){$.ajax({url:"https://api.foursquare.com/v2/venues/"+r.id()+"?client_id="+foursquare_id+"&client_secret="+foursquare_secret+"&v=201701401&m=foursquare",dataType:"json",success:function(e){var a=e.response.venue,s=a.hasOwnProperty("location")?a.location:"";s.hasOwnProperty("address")&&r.address(s.address||"n/a");var o=a.hasOwnProperty("rating")?a.rating:"";r.rating(o||"n/a");var t=a.hasOwnProperty("likes")?a.likes:"";t.hasOwnProperty("summary")&&r.likes(t.summary||"n/a");var i=a.hasOwnProperty("bestPhoto")?a.bestPhoto:"";if(i.hasOwnProperty("prefix")&&i.hasOwnProperty("suffix")){var n=i.prefix+"300x300"+i.suffix;r.photo(n||"n/a")}var l=a.hasOwnProperty("canonicalUrl")?a.canonicalUrl:"";r.url(l||"n/a")},complete:function(e){var a='<div class="result-info"><p class="result-title">'+r.title()+'</p><p class="result-address">'+r.address()+'</p><p class="result-rating">'+r.rating()+'</p><p class="result-likes">'+r.likes()+'</p><p><a class="result-url" href="'+r.url()+'" target="_blank">Learn more on Foursquare</a></p><p><img class="result-powered" src="img/foursquare-logo.png"></p></div>';r.marker.addListener("click",function(){info.open(map,r.marker),info.setContent(a),r.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){r.marker.setAnimation(null)},2100)})},error:function(e){var a='<div class="result-info"><p class="result-title">'+r.title+'</p><p class="result-address">Foursquare Data Not Available</p></div>';r.marker.addListener("click",function(){info.open(map,r.marker),info.setContent(a),r.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){r.marker.setAnimation(null)},2100)})}})}),this.filteredMarkers=ko.computed(function(){var e=r.searchText().toLowerCase();r.visibleArray.removeAll(),r.locationArray().forEach(function(a){a.marker.setVisible(!1),a.title().toLowerCase().indexOf(e)>-1&&r.visibleArray.push(a)}),0==r.visibleArray().length?r.error("No Results"):(r.error(""),r.visibleArray().forEach(function(r){r.marker.setVisible(!0)}))}),this.getInfo=function(r){google.maps.event.trigger(r.marker,"click"),map.panTo(r.marker.position),map.setZoom(14)}}